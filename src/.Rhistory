dbGetQuery(ergastdb, q)
q='SELECT * FROM races r JOIN circuits c ON r.circuitId=c.circuitID WHERE circuitref=albert_park'
#The dbGetQuery() function is provided by the DBI library
dbGetQuery(ergastdb, q)
q='SELECT * FROM races r JOIN circuits c ON r.circuitId=c.circuitID WHERE circuitref="albert_park"'
#The dbGetQuery() function is provided by the DBI library
dbGetQuery(ergastdb, q)
q='SELECT year, round FROM races r JOIN circuits c JOIN results rs  WHERE r.circuitId=c.circuitID AND r.raceId=rs.raceId AND position<=10 AND circuitref="albert_park"'
#The dbGetQuery() function is provided by the DBI library
dbGetQuery(ergastdb, q)
q='SELECT year, code, positionFROM races r JOIN circuits c JOIN results rs JOIN drivers d WHERE r.circuitId=c.circuitID AND r.raceId=rs.raceId AND position<=10 AND d.driverID=rs.driverId AND circuitref="albert_park"'
#The dbGetQuery() function is provided by the DBI library
dbGetQuery(ergastdb, q)
q='SELECT year, code, positionFROM races r JOIN circuits c JOIN results rs JOIN drivers d WHERE r.circuitId=c.circuitId AND r.raceId=rs.raceId AND position<=10 AND d.driverID=rs.driverId AND circuitref="albert_park"'
#The dbGetQuery() function is provided by the DBI library
dbGetQuery(ergastdb, q)
q='SELECT year, code, position FROM races r JOIN circuits c JOIN results rs JOIN drivers d WHERE r.circuitId=c.circuitId AND r.raceId=rs.raceId AND position<=10 AND d.driverID=rs.driverId AND circuitref="albert_park"'
#The dbGetQuery() function is provided by the DBI library
dbGetQuery(ergastdb, q)
require(knitr)
opts_chunk$set(fig.path = "images/ergastdatadb-")
library(RMySQL)
ergastdb=dbConnect(MySQL(),user='root',password='f1',host='127.0.0.1',port=3399,dbname='ergastdb')
q='SELECT   FROM races r JOIN circuits c ON r.circuitId=c.circuitID WHERE circuitref="albert_park"'
#The dbGetQuery() function is provided by the DBI library
dbGetQuery(ergastdb, q)
q='SELECT  * FROM races r JOIN circuits c ON r.circuitId=c.circuitID WHERE circuitref="albert_park"'
#The dbGetQuery() function is provided by the DBI library
dbGetQuery(ergastdb, q)
q='SELECT year, code, position FROM races r JOIN circuits c JOIN results rs JOIN drivers d WHERE r.circuitId=c.circuitId AND r.raceId=rs.raceId AND position<=10 AND d.driverID=rs.driverId AND circuitref="albert_park"'
#The dbGetQuery() function is provided by the DBI library
res = dbGetQuery(ergastdb, q)
q='SELECT year, code, position FROM races r JOIN circuits c JOIN results rs JOIN drivers d WHERE r.circuitId=c.circuitId AND r.raceId=rs.raceId AND position<=10 AND d.driverID=rs.driverId AND circuitref="albert_park"'
#The dbGetQuery() function is provided by the DBI library
res = dbGetQuery(ergastdb, q)
res
library(ggplot2)
g=ggplot(res)+ geom_line(aes(x=))
library(ggplot2)
g=ggplot(res)+ geom_line(aes(x=year, y=position, col=code))
g
require(knitr)
opts_chunk$set(fig.path = "images/ergastdatadb-")
library(RMySQL)
ergastdb=dbConnect(MySQL(),user='root',password='f1',host='127.0.0.1',port=3399,dbname='ergastdb')
q='SELECT  * FROM races r JOIN circuits c ON r.circuitId=c.circuitID WHERE circuitref="albert_park"'
#The dbGetQuery() function is provided by the DBI library
dbGetQuery(ergastdb, q)
q='SELECT year, code, position FROM races r JOIN circuits c JOIN results rs JOIN drivers d WHERE r.circuitId=c.circuitId AND r.raceId=rs.raceId AND position<=10 AND d.driverID=rs.driverId AND circuitref="albert_park"'
#The dbGetQuery() function is provided by the DBI library
res = dbGetQuery(ergastdb, q)
res
res$pts = 11-res$position
res
q='SELECT year, code, position FROM races r JOIN circuits c JOIN results rs JOIN drivers d WHERE r.circuitId=c.circuitId AND r.raceId=rs.raceId AND position<=10 AND d.driverID=rs.driverId AND circuitref="albert_park" ORDER BY year'
#The dbGetQuery() function is provided by the DBI library
res = dbGetQuery(ergastdb, q)
res
q='SELECT year, driverRef, position FROM races r JOIN circuits c JOIN results rs JOIN drivers d WHERE r.circuitId=c.circuitId AND r.raceId=rs.raceId AND position<=10 AND d.driverID=rs.driverId AND circuitref="albert_park" ORDER BY year'
#The dbGetQuery() function is provided by the DBI library
res = dbGetQuery(ergastdb, q)
res
res$pts = 11-res$position
res
mutate(group_by(res,driverRef), cumsum=cumsum(pts
))
ddply(res, .(driverRef), transform, product=cumsum(pts))  ))
ddply(res, .(driverRef), transform, product=cumsum(pts)  )
library(plyr)
ddply(res, .(driverRef), transform, product=cumsum(pts)  )
library(plyr)
res = ddply(res, .(driverRef), transform, totPts=cumsum(pts)  )
library(plyr)
res = ddply(res, .(driverRef), transform, totPts=cumsum(pts)  )
res
library(ggplot2)
g=ggplot(res)+ geom_line(aes(x=year, y=totPts, col=driverRef))
g
library(ggplot2)
g=ggplot(res)+ geom_line(aes(x=year, y=totPts, col=driverRef))
g+ guides(fill=FALSE)
library(ggplot2)
g=ggplot(res)+ geom_line(aes(x=year, y=totPts, col=driverRef))
g+ guides(color=FALSE)
library(directlabels)
install.packages("directlabels")
install.packages("ggrepel")
library(ggplot2)
#library(directlabels)
library(ggrepel)
g=ggplot(res)+ geom_line(aes(x=year, y=totPts, col=driverRef))
g=g+geom_label_repel(aes(label = driverRef),
nudge_x = 1,
na.rm = TRUE)
#geom_dl(aes(label = driverRef), method = list(dl.combine("first.points", "last.points"), cex = 0.8)
g + guides(color=FALSE)
library(ggplot2)
#library(directlabels)
library(ggrepel)
g=ggplot(res, aes(x=year, y=totPts))+ geom_line(aes( col=driverRef))
g=g+geom_label_repel(aes(label = driverRef),
nudge_x = 1,
na.rm = TRUE)
#geom_dl(aes(label = driverRef), method = list(dl.combine("first.points", "last.points"), cex = 0.8)
g + guides(color=FALSE)
q='SELECT driverRef, SUM(position) FROM races r JOIN circuits c JOIN results rs JOIN drivers d WHERE r.circuitId=c.circuitId AND r.raceId=rs.raceId AND position<=10 AND d.driverID=rs.driverId AND circuitref="albert_park" ORDER BY year GROUP BY driverRef'
dbGetQuery(ergastdb, q)
q='SELECT driverRef, SUM(position) FROM races r JOIN circuits c JOIN results rs JOIN drivers d WHERE r.circuitId=c.circuitId AND r.raceId=rs.raceId AND position<=10 AND d.driverID=rs.driverId AND circuitref="albert_park" GROUP BY driverRef'
dbGetQuery(ergastdb, q)
q='SELECT year, driverRef, SUM(position) FROM races r JOIN circuits c JOIN results rs JOIN drivers d WHERE r.circuitId=c.circuitId AND r.raceId=rs.raceId AND position<=10 AND d.driverID=rs.driverId AND circuitref="albert_park" GROUP BY driverRef ORDER BY year'
dbGetQuery(ergastdb, q)
q='SELECT driverRef, SUM(11-position) FROM races r JOIN circuits c JOIN results rs JOIN drivers d WHERE r.circuitId=c.circuitId AND r.raceId=rs.raceId AND position<=10 AND d.driverID=rs.driverId AND circuitref="albert_park" GROUP BY driverRef ORDER BY year'
dbGetQuery(ergastdb, q)
q='SELECT driverRef, SUM(11-position) s FROM races r JOIN circuits c JOIN results rs JOIN drivers d WHERE r.circuitId=c.circuitId AND r.raceId=rs.raceId AND position<=10 AND d.driverID=rs.driverId AND circuitref="albert_park" GROUP BY driverRef ORDER BY s'
dbGetQuery(ergastdb, q)
q='SELECT driverRef, SUM(11-position) s FROM races r JOIN circuits c JOIN results rs JOIN drivers d WHERE r.circuitId=c.circuitId AND r.raceId=rs.raceId AND position<=10 AND d.driverID=rs.driverId AND circuitref="albert_park" GROUP BY driverRef ORDER BY s DESC'
dbGetQuery(ergastdb, q)
q='SELECT driverRef, SUM(11-position) s FROM races r JOIN circuits c JOIN results rs JOIN drivers d WHERE r.circuitId=c.circuitId AND r.raceId=rs.raceId AND position<=10 AND d.driverID=rs.driverId AND circuitref="albert_park" GROUP BY driverRef ORDER BY s DESC HAVING s>50'
dbGetQuery(ergastdb, q)
q='SELECT driverRef, SUM(11-position) s FROM races r JOIN circuits c JOIN results rs JOIN drivers d WHERE r.circuitId=c.circuitId AND r.raceId=rs.raceId AND position<=10 AND d.driverID=rs.driverId AND circuitref="albert_park" GROUP BY driverRef ORDER BY s DESC HAVING SUM(11-position) > 50'
dbGetQuery(ergastdb, q)
q='SELECT driverRef, SUM(11-position) s FROM races r JOIN circuits c JOIN results rs JOIN drivers d WHERE r.circuitId=c.circuitId AND r.raceId=rs.raceId AND position<=10 AND d.driverID=rs.driverId AND circuitref="albert_park" GROUP BY driverRef  DESC HAVING SUM(11-position) > 50 ORDER BY s'
dbGetQuery(ergastdb, q)
q='SELECT driverRef, SUM(11-position) s FROM races r JOIN circuits c JOIN results rs JOIN drivers d WHERE r.circuitId=c.circuitId AND r.raceId=rs.raceId AND position<=10 AND d.driverID=rs.driverId AND circuitref="albert_park" GROUP BY driverRef  DESC HAVING s > 50 ORDER BY s'
dbGetQuery(ergastdb, q)
q='SELECT driverRef, SUM(11-position) s FROM races r JOIN circuits c JOIN results rs JOIN drivers d WHERE r.circuitId=c.circuitId AND r.raceId=rs.raceId AND position<=10 AND d.driverID=rs.driverId AND circuitref="albert_park" GROUP BY driverRef  DESC HAVING s > 50 ORDER BY s'
leaders = dbGetQuery(ergastdb, q)
q='SELECT driverRef, SUM(11-position) s FROM races r JOIN circuits c JOIN results rs JOIN drivers d WHERE r.circuitId=c.circuitId AND r.raceId=rs.raceId AND position<=10 AND d.driverID=rs.driverId AND circuitref="albert_park" GROUP BY driverRef  DESC HAVING s > 50 ORDER BY s'
leaders = dbGetQuery(ergastdb, q)
leaders
q='SELECT driverRef, MAX(year),SUM(11-position) s FROM races r JOIN circuits c JOIN results rs JOIN drivers d WHERE r.circuitId=c.circuitId AND r.raceId=rs.raceId AND position<=10 AND d.driverID=rs.driverId AND circuitref="albert_park" GROUP BY driverRef  DESC HAVING s > 50 ORDER BY s'
leaders = dbGetQuery(ergastdb, q)
leaders
q='SELECT driverRef, MAX(year) as until,SUM(11-position) s FROM races r JOIN circuits c JOIN results rs JOIN drivers d WHERE r.circuitId=c.circuitId AND r.raceId=rs.raceId AND position<=10 AND d.driverID=rs.driverId AND circuitref="albert_park" GROUP BY driverRef  DESC HAVING s > 50 ORDER BY s'
leaders = dbGetQuery(ergastdb, q)
leaders
library(ggplot2)
#library(directlabels)
library(ggrepel)
g=ggplot(res, aes(x=year, y=totPts))+ geom_line(aes( col=driverRef))
g=g+geom_label_repel(leaders,aes(x=until, y=s,label = driverRef),
nudge_x = 1,
na.rm = TRUE)
library(ggplot2)
#library(directlabels)
library(ggrepel)
g=ggplot(res, aes(x=year, y=totPts))+ geom_line(aes( col=driverRef))
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = driverRef),
nudge_x = 1,
na.rm = TRUE)
#geom_dl(aes(label = driverRef), method = list(dl.combine("first.points", "last.points"), cex = 0.8)
g + guides(color=FALSE)
library(ggplot2)
#library(directlabels)
library(ggrepel)
g=ggplot(res, aes(x=year, y=totPts))+ geom_step(aes( col=driverRef))
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = driverRef),
nudge_x = 1,
na.rm = TRUE)
#geom_dl(aes(label = driverRef), method = list(dl.combine("first.points", "last.points"), cex = 0.8)
g + guides(color=FALSE)
library(ggplot2)
#library(directlabels)
library(ggrepel)
g=ggplot(res, aes(x=year, y=totPts))+ geom_step(aes( col=driverRef))
#g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = driverRef),
nudge_x = 1,
library(ggplot2)
#library(directlabels)
library(ggrepel)
g=ggplot(res, aes(x=year, y=totPts))+ geom_step(aes( col=driverRef))
#g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = driverRef),nudge_x = 1, na.rm = TRUE)
g=g+geom_dl(aes(label = driverRef), method = list(dl.combine( "last.points"), cex = 0.8)
g + guides(color=FALSE)
library(ggplot2)
#library(directlabels)
library(ggrepel)
g=ggplot(res, aes(x=year, y=totPts))+ geom_step(aes( col=driverRef))
#g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = driverRef),nudge_x = 1, na.rm = TRUE)
g=g+geom_dl(aes(label = driverRef), method = list(dl.combine( "last.points")), cex = 0.8)
library(ggplot2)
library(directlabels)
library(ggrepel)
g=ggplot(res, aes(x=year, y=totPts))+ geom_step(aes( col=driverRef))
#g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = driverRef),nudge_x = 1, na.rm = TRUE)
g=g+geom_dl(aes(label = driverRef), method = list(dl.combine( "last.points")), cex = 0.8)
g + guides(color=FALSE)
library(ggplot2)
library(directlabels)
library(ggrepel)
g=ggplot(res, aes(x=year, y=totPts))+ geom_step(aes( col=driverRef))
#g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = driverRef),nudge_x = 1, na.rm = TRUE)
g=g+geom_dl(data=leaders,aes(x=until, y=s,label = driverRef), method = list(dl.combine( "last.points")), cex = 0.8)
g + guides(color=FALSE)
g=ggplot(res, aes(x=year, y=totPts))+ geom_step(aes( col=driverRef))
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = driverRef),nudge_x = 1, na.rm = TRUE)
g + guides(color=FALSE)
g=ggplot(res, aes(x=year, y=totPts))+ geom_step(aes( col=driverRef))
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = driverRef),nudge_x = 5, na.rm = TRUE)
g + guides(color=FALSE)
g=ggplot(res, aes(x=year, y=totPts))+ geom_step(aes( col=driverRef))
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = driverRef),nudge_x = -5, na.rm = TRUE)
g + guides(color=FALSE)
g=ggplot(res, aes(x=year, y=totPts))+ geom_step(aes( col=driverRef))
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = driverRef),nudge_x = -1, na.rm = TRUE)
g + guides(color=FALSE)
g=ggplot(res, aes(x=year, y=totPts))+ geom_step(aes( col=driverRef))
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = driverRef),nudge_x = -1,nudge_y = 1 na.rm = TRUE)
g=ggplot(res, aes(x=year, y=totPts))+ geom_step(aes( col=driverRef))
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = driverRef),nudge_x = -1,nudge_y = 1, na.rm = TRUE)
g + guides(color=FALSE)
g=ggplot(res, aes(x=year, y=totPts))+ geom_step(aes( col=driverRef))
g=g+geom_text_repel(data=leaders,aes(x=until, y=s,label = driverRef),nudge_x = -1,nudge_y = 1, na.rm = TRUE)
g + guides(color=FALSE)
g=ggplot(res, aes(x=year, y=totPts))+ geom_step(aes( col=driverRef))
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = driverRef),nudge_x = -1,nudge_y = 1, na.rm = TRUE)
g + guides(color=FALSE)
g=ggplot(res, aes(x=year, y=totPts))+ geom_step(aes( col=driverRef))
g=g+geom_text_repel(data=leaders,aes(x=until, y=s,label = driverRef),nudge_x = -1,nudge_y = 1, na.rm = TRUE)
g + guides(color=FALSE)
g=ggplot(res, aes(x=year, y=totPts))+ geom_step(aes( col=driverRef))
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = driverRef),nudge_x = 10,nudge_y = 1, na.rm = TRUE)
g + guides(color=FALSE)
g=ggplot(res, aes(x=year, y=totPts))+ geom_step(aes( col=driverRef))
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = driverRef),nudge_x = -10,nudge_y = 1, na.rm = TRUE)
g + guides(color=FALSE)
g=ggplot(res, aes(x=year, y=totPts))+ geom_lin(aes( col=driverRef))
g=ggplot(res, aes(x=year, y=totPts))+ geom_line(aes( col=driverRef))
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = driverRef),nudge_x = -10,nudge_y = 1, na.rm = TRUE)
g + guides(color=FALSE)
g=ggplot(res, aes(x=year, y=totPts))+ geom_line(aes( col=driverRef))
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = driverRef),nudge_x = +10,nudge_y = 1, na.rm = TRUE)
g + guides(color=FALSE)+xlim(1995,2021)
g=ggplot(res, aes(x=year, y=totPts))+ geom_line(aes( col=driverRef))
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = driverRef),nudge_x = +10,nudge_y = 1, na.rm = TRUE)
g + guides(color=FALSE)+xlim(1995,2030)
g=ggplot(res, aes(x=year, y=totPts))+ geom_line(aes( col=driverRef))
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = driverRef),nudge_x = +5,nudge_y = 1, na.rm = TRUE)
g + guides(color=FALSE)+xlim(1995,2030)
g=ggplot(res, aes(x=year, y=totPts))+ geom_line(aes( col=driverRef))
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = driverRef),nudge_x = +3,nudge_y = 1, na.rm = TRUE)
g + guides(color=FALSE)+xlim(1995,2030)
g=ggplot(res, aes(x=year, y=totPts))+ geom_line(aes( col=driverRef))
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = driverRef),nudge_x = -10,nudge_y = 10, na.rm = TRUE)
g + guides(color=FALSE)+xlim(1995,2030)
g=ggplot(res, aes(x=year, y=totPts))+ geom_line(aes( col=driverRef))
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = driverRef),nudge_x = -10,nudge_y = 10, na.rm = TRUE)
g + guides(color=FALSE)+xlim(1995,2030)+ylim(0,100)
g=ggplot(res, aes(x=year, y=totPts))+ geom_line(aes( col=driverRef))
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = driverRef),nudge_x = -0,nudge_y = 10, na.rm = TRUE)
g + guides(color=FALSE)+xlim(1995,2030)+ylim(0,100)
g=ggplot(res, aes(x=year, y=totPts))+ geom_line(aes( col=driverRef))
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = driverRef),nudge_x = -0,nudge_y = 10, na.rm = TRUE, arrow = arrow(length = unit(0.01, 'npc')))
g + guides(color=FALSE)+xlim(1995,2030)+ylim(0,100)
g=ggplot(res, aes(x=year, y=totPts))+ geom_line(aes( col=driverRef))
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = driverRef),nudge_x = -0,nudge_y = 0, na.rm = TRUE, arrow = arrow(length = unit(0.01, 'npc')))
g + guides(color=FALSE)+xlim(1995,2030)+ylim(0,100)
g=ggplot(res, aes(x=year, y=totPts))+ geom_line(aes( col=driverRef))
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = driverRef),nudge_x = -0,nudge_y = 10, na.rm = TRUE, arrow = arrow(length = unit(0.01, 'npc')))
g + guides(color=FALSE)+xlim(1995,2030)+ylim(0,100)
q='SELECT year, driverRef, code, position FROM races r JOIN circuits c JOIN results rs JOIN drivers d WHERE r.circuitId=c.circuitId AND r.raceId=rs.raceId AND position<=10 AND d.driverID=rs.driverId AND circuitref="albert_park" ORDER BY year'
#The dbGetQuery() function is provided by the DBI library
res = dbGetQuery(ergastdb, q)
res
q='SELECT driverRef, code, MAX(year) as until,SUM(11-position) s FROM races r JOIN circuits c JOIN results rs JOIN drivers d WHERE r.circuitId=c.circuitId AND r.raceId=rs.raceId AND position<=10 AND d.driverID=rs.driverId AND circuitref="albert_park" GROUP BY driverRef  DESC HAVING s > 50 ORDER BY s'
leaders = dbGetQuery(ergastdb, q)
q='SELECT driverRef, code, MAX(year) as until,SUM(11-position) s FROM races r JOIN circuits c JOIN results rs JOIN drivers d WHERE r.circuitId=c.circuitId AND r.raceId=rs.raceId AND position<=10 AND d.driverID=rs.driverId AND circuitref="albert_park" GROUP BY driverRef, code  DESC HAVING s > 50 ORDER BY s'
leaders = dbGetQuery(ergastdb, q)
leaders
library(ggplot2)
library(directlabels)
library(ggrepel)
g=ggplot(res, aes(x=year, y=totPts))+ geom_step(aes( col=code))
#g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = driverRef),nudge_x = 1, na.rm = TRUE)
g=g+geom_dl(data=leaders,aes(x=until, y=s,label = driverRef), method = list(dl.combine( "last.points")), cex = 0.8)
g + guides(color=FALSE)
res$pts = 11-res$position
res
library(ggplot2)
library(directlabels)
library(ggrepel)
g=ggplot(res, aes(x=year, y=totPts))+ geom_step(aes( col=code))
#g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = driverRef),nudge_x = 1, na.rm = TRUE)
g=g+geom_dl(data=leaders,aes(x=until, y=s,label = driverRef), method = list(dl.combine( "last.points")), cex = 0.8)
g + guides(color=FALSE)
res$pts = 11-res$position
res
library(plyr)
res = ddply(res, .(driverRef), transform, totPts=cumsum(pts)  )
res
library(ggplot2)
library(directlabels)
library(ggrepel)
g=ggplot(res, aes(x=year, y=totPts))+ geom_step(aes( col=code))
#g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = driverRef),nudge_x = 1, na.rm = TRUE)
g=g+geom_dl(data=leaders,aes(x=until, y=s,label = driverRef), method = list(dl.combine( "last.points")), cex = 0.8)
g + guides(color=FALSE)
g=ggplot(res, aes(x=year, y=totPts))+ geom_step(aes( col=driverRef))
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = driverRef),nudge_x = -10,nudge_y = 1, na.rm = TRUE)
g + guides(color=FALSE)
g=ggplot(res, aes(x=year, y=totPts))+ geom_step(aes( col=code))
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = code),nudge_x = -10,nudge_y = 1, na.rm = TRUE)
g + guides(color=FALSE)
library(ggplot2)
library(directlabels)
library(ggrepel)
g=ggplot(res, aes(x=year, y=totPts))+ geom_step(aes( col=code))
#g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = driverRef),nudge_x = 1, na.rm = TRUE)
g=g+geom_dl(data=leaders,aes(x=until, y=s,label = code), method = list(dl.combine( "last.points")), cex = 0.8)
g + guides(color=FALSE)
g=ggplot(res, aes(x=year, y=totPts))+ geom_line(aes( col=code))
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = code),nudge_x = -0,nudge_y = 10, na.rm = TRUE, arrow = arrow(length = unit(0.01, 'npc')))
g + guides(color=FALSE)+xlim(1995,2030)+ylim(0,100)
g=ggplot(res, aes(x=year, y=totPts))+ geom_step(aes( col=code))
g=g+geom_text_repel(data=leaders,aes(x=until, y=s,label =   code),nudge_x = -1,nudge_y = 1, na.rm = TRUE)
g + guides(color=FALSE)
g=ggplot(res, aes(x=year, y=totPts))+ geom_line(aes( col=code))
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = code), na.rm = TRUE, arrow = arrow(length = unit(0.01, 'npc')))
g + guides(color=FALSE)+xlim(1995,2030)+ylim(0,100)
g=ggplot(res, aes(x=year, y=totPts))+ geom_line(aes( col=code))
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = code), na.rm = TRUE, arrow = arrow(length = unit(0.01, 'npc'), nudge_y =1))
g=ggplot(res, aes(x=year, y=totPts))+ geom_line(aes( col=code))
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = code), na.rm = TRUE, arrow = arrow(length = unit(0.01, 'npc')), nudge_y =1)
g + guides(color=FALSE)+xlim(1995,2030)+ylim(0,100)
g=ggplot(res, aes(x=year, y=totPts))+ geom_line(aes( col=code))
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = code), na.rm = TRUE, arrow = arrow(length = unit(0.01, 'npc')), nudge_y =1, nudge_x =1)
g + guides(color=FALSE)+xlim(1995,2030)+ylim(0,100)
g=ggplot(res, aes(x=year, y=totPts))+ geom_line(aes( col=code))
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = code), na.rm = TRUE, arrow = arrow(length = unit(0.01, 'npc')), nudge_y =2, nudge_x =1)
g + guides(color=FALSE)+xlim(1995,2030)+ylim(0,100)
g=ggplot(res, aes(x=year, y=totPts))+ geom_line(aes( col=code))
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = code), na.rm = TRUE, arrow = arrow(length = unit(0.01, 'npc')), nudge_y =3, nudge_x =1)
g + guides(color=FALSE)+xlim(1995,2030)+ylim(0,100)
g=ggplot(res, aes(x=year, y=totPts))+ geom_line(aes( col=code))
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = code), na.rm = TRUE, arrow = arrow(length = unit(0.01, 'npc')), nudge_y =3, nudge_x =2)
g + guides(color=FALSE)+xlim(1995,2030)+ylim(0,100)
g=ggplot(res, aes(x=year, y=totPts))+ geom_line(aes( col=code))
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = code), na.rm = TRUE, arrow = arrow(length = unit(0.01, 'npc')), nudge_y =3, nudge_x =3)
g + guides(color=FALSE)+xlim(1995,2030)+ylim(0,100)
g=ggplot(res, aes(x=year, y=totPts))+ geom_line(aes( col=code))
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = code), na.rm = TRUE, arrow = arrow(length = unit(0.01, 'npc')), nudge_y =3, nudge_x =5)
g + guides(color=FALSE)+xlim(1995,2030)+ylim(0,100)
g=ggplot(res, aes(x=year, y=totPts))+ geom_line(aes( col=code))
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = code), na.rm = TRUE, arrow = arrow(length = unit(0.01, 'npc')), nudge_y =3, nudge_x =5, size=3)
g + guides(color=FALSE)+xlim(1995,2030)+ylim(0,100)
g=ggplot(res, aes(x=year, y=totPts))+ geom_line(aes( col=code))
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = code), na.rm = TRUE, arrow = arrow(length = unit(0.01, 'npc')), nudge_y =3, nudge_x =5, size=1)
g + guides(color=FALSE)+xlim(1995,2030)+ylim(0,100)
g=ggplot(res, aes(x=year, y=totPts))+ geom_line(aes( col=code))
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = code), na.rm = TRUE, arrow = arrow(length = unit(0.01, 'npc')), nudge_y =3, nudge_x =5, size=2)
g + guides(color=FALSE)+xlim(1995,2030)+ylim(0,100)
g=ggplot(res, aes(x=year, y=totPts))+ geom_line(aes( col=code))
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = code), na.rm = TRUE, arrow = arrow(length = unit(0.01, 'npc')), nudge_y =3, nudge_x =3, size=2)
g + guides(color=FALSE)+xlim(1995,2030)+ylim(0,100)
g=ggplot(res, aes(x=year, y=totPts))+ geom_line(aes( col=code))
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = code), na.rm = TRUE, arrow = arrow(length = unit(0.01, 'npc')), nudge_y =3, nudge_x =3, segment.size = 0.5,size=2)
g + guides(color=FALSE)+xlim(1995,2030)+ylim(0,100)
g=ggplot(res, aes(x=year, y=totPts))+ geom_line(aes( col=code))
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = code), na.rm = TRUE, arrow = arrow(length = unit(0.01, 'npc')), nudge_y =3, nudge_x =3, segment.size = 0.2,size=2)
g + guides(color=FALSE)+xlim(1995,2030)+ylim(0,100)
g=ggplot(res, aes(x=year, y=totPts))+ geom_line(aes( col=code))
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = code), na.rm = TRUE, arrow = arrow(length = unit(0.01, 'npc')), nudge_y =3, nudge_x =3, segment.size = 0.2,size=2)
g + guides(color=FALSE)+xlim(1995,2030)+ylim(0,100)+theme_blank()
library(ggplot2)
library(directlabels)
library(ggrepel)
library(ggthemes)
g=ggplot(res, aes(x=year, y=totPts))+ geom_step(aes( col=code))
#g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = driverRef),nudge_x = 1, na.rm = TRUE)
g=g+geom_dl(data=leaders,aes(x=until, y=s,label = code), method = list(dl.combine( "last.points")), cex = 0.8)
g + guides(color=FALSE)
g=ggplot(res, aes(x=year, y=totPts))+ geom_line(aes( col=code))
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = code), na.rm = TRUE, arrow = arrow(length = unit(0.01, 'npc')), nudge_y =3, nudge_x =3, segment.size = 0.2,size=2)
g + guides(color=FALSE)+xlim(1995,2030)+ylim(0,100)+theme_bw()
g=ggplot(res, aes(x=year, y=totPts))+ geom_line(aes( col=code))
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = code), na.rm = TRUE, arrow = arrow(length = unit(0.01, 'npc')), nudge_y =3, nudge_x =3, segment.size = 0.2,size=2)
g + guides(color=FALSE)+xlim(1995,2025)+ylim(0,100)+theme_bw()
leaders$code
g=ggplot()+ geom_line(res[res$code %in% leaders$code,], aes(x=year, y=totPts, col=code))
g=ggplot()+ geom_line(res[res$code %in% c('HAM),], aes(x=year, y=totPts, col=code))
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = code), na.rm = TRUE, arrow = arrow(length = unit(0.01, 'npc')), nudge_y =3, nudge_x =3, segment.size = 0.2,size=2)
g=ggplot()+ geom_line(res[res$code %in% c('HAM'),], aes(x=year, y=totPts, col=code))
g=ggplot()+ geom_line(data=res[res$code %in% c('HAM'),], aes(x=year, y=totPts, col=code))
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = code), na.rm = TRUE, arrow = arrow(length = unit(0.01, 'npc')), nudge_y =3, nudge_x =3, segment.size = 0.2,size=2)
g + guides(color=FALSE)+xlim(1995,2025)+ylim(0,100)+theme_bw()
g=ggplot()+ geom_line(data=res[res$code %in% leaders$code,], aes(x=year, y=totPts, col=code))
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = code), na.rm = TRUE, arrow = arrow(length = unit(0.01, 'npc')), nudge_y =3, nudge_x =3, segment.size = 0.2,size=2)
g + guides(color=FALSE)+xlim(1995,2025)+ylim(0,100)+theme_bw()
g=ggplot()+ geom_line(data=res[res$code %in% leaders$code,], aes(x=year, y=totPts, col=code))
g=g+ geom_line(data=res[!(res$code %in% leaders$code),], aes(x=year, y=totPts),col='grey')
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = code), na.rm = TRUE, arrow = arrow(length = unit(0.01, 'npc')), nudge_y =3, nudge_x =3, segment.size = 0.2,size=2)
g + guides(color=FALSE)+xlim(1995,2025)+ylim(0,100)+theme_bw()
g=ggplot()+ geom_line(data=res[res$code %in% leaders$code,], aes(x=year, y=totPts, col=code))
g=g+ geom_line(data=res[!(res$code %in% leaders$code),], aes(x=year, y=totPts, group=driverRef),col='grey')
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = code), na.rm = TRUE, arrow = arrow(length = unit(0.01, 'npc')), nudge_y =3, nudge_x =3, segment.size = 0.2,size=2)
g + guides(color=FALSE)+xlim(1995,2025)+ylim(0,100)+theme_bw()
g=ggplot()+ geom_line(data=res[res$code %in% leaders$code,], aes(x=year, y=totPts, col=code))
g=g+ geom_line(data=res[!(res$code %in% leaders$code),], aes(x=year, y=totPts, group=driverRef),col='grey')
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = code), na.rm = TRUE, arrow = arrow(length = unit(0.01, 'npc')), nudge_y =2, nudge_x =3, segment.size = 0.2,size=2)
g + guides(color=FALSE)+xlim(1995,2025)+ylim(0,100)+theme_bw()
g=ggplot()+ geom_line(data=res[res$code %in% leaders$code,], aes(x=year, y=totPts, col=code))
g=g+ geom_line(data=res[!(res$code %in% leaders$code),], aes(x=year, y=totPts, group=driverRef),col='grey')
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = code), na.rm = TRUE, arrow = arrow(length = unit(0.01, 'npc')), nudge_y =3, nudge_x =2, segment.size = 0.2,size=2)
g + guides(color=FALSE)+xlim(1995,2025)+ylim(0,100)+theme_bw()
g=ggplot()+ geom_line(data=res[res$code %in% leaders$code,], aes(x=year, y=totPts, col=code))
g=g+ geom_line(data=res[!(res$code %in% leaders$code),], aes(x=year, y=totPts, group=driverRef),col='grey')
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = code), na.rm = TRUE, arrow = arrow(length = unit(0.01, 'npc')), nudge_y =3, nudge_x =1, segment.size = 0.2,size=2)
g + guides(color=FALSE)+xlim(1995,2025)+ylim(0,100)+theme_bw()
g=ggplot()+ geom_line(data=res[res$code %in% leaders$code,], aes(x=year, y=totPts, col=code))
g=g+ geom_line(data=res[!(res$code %in% leaders$code),], aes(x=year, y=totPts, group=driverRef),col='grey')
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = code), na.rm = TRUE, arrow = arrow(length = unit(0.01, 'npc')), nudge_y =3, nudge_x =1.5, segment.size = 0.2,size=2)
g + guides(color=FALSE)+xlim(1995,2025)+ylim(0,100)+theme_bw()
g=ggplot()+ geom_line(data=res[res$code %in% leaders$code,], aes(x=year, y=totPts, col=code))
g=g+ geom_line(data=res[!(res$code %in% leaders$code),], aes(x=year, y=totPts, group=driverRef),col='grey')
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = code), na.rm = TRUE, arrow = arrow(length = unit(0.01, 'npc')), nudge_y =3, nudge_x =2, segment.size = 0.2,size=2)
g + guides(color=FALSE)+xlim(1995,2025)+ylim(0,100)+theme_bw()
g=ggplot()+ geom_step(data=res[res$code %in% leaders$code,], aes(x=year, y=totPts, col=code))
g=g+ geom_line(data=res[!(res$code %in% leaders$code),], aes(x=year, y=totPts, group=driverRef),col='grey')
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = code), na.rm = TRUE, arrow = arrow(length = unit(0.01, 'npc')), nudge_y =3, nudge_x =2, segment.size = 0.2,size=2)
g + guides(color=FALSE)+xlim(1995,2025)+ylim(0,100)+theme_bw()
g=ggplot()+ geom_step(data=res[res$code %in% leaders$code,], aes(x=year, y=totPts, col=code))
g=g+ geom_line(data=res[!(res$code %in% leaders$code),], aes(x=year, y=totPts, group=driverRef),col='grey')
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = code), na.rm = TRUE, arrow = arrow(length = unit(0.01, 'npc')), nudge_y =3, nudge_x =2, segment.size = 0.2,size=2)
g + guides(color=FALSE)+xlim(1995,2025)+ylim(0,100)+theme_bw()+ggtitle('sdsd')
g=ggplot()+ geom_step(data=res[res$code %in% leaders$code,], aes(x=year, y=totPts, col=code))
g=g+ geom_line(data=res[!(res$code %in% leaders$code),], aes(x=year, y=totPts, group=driverRef),col='grey')
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = code), na.rm = TRUE, arrow = arrow(length = unit(0.01, 'npc')), nudge_y =3, nudge_x =2, segment.size = 0.2,size=2)
g=g + guides(color=FALSE)+xlim(1995,2025)+ylim(0,100)+theme_bw()+ggtitle('F1 Australia - Albert Park - Driver Performance')
g+ annotate("text", x = 1995, y = 95, label = "10 points for 1st down 1 point for 10th")
g=ggplot()+ geom_step(data=res[res$code %in% leaders$code,], aes(x=year, y=totPts, col=code))
g=g+ geom_line(data=res[!(res$code %in% leaders$code),], aes(x=year, y=totPts, group=driverRef),col='grey')
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = code), na.rm = TRUE, arrow = arrow(length = unit(0.01, 'npc')), nudge_y =3, nudge_x =2, segment.size = 0.2,size=2)
g=g + guides(color=FALSE)+xlim(1995,2025)+ylim(0,100)+theme_bw()+ggtitle('F1 Australia - Albert Park - Driver Performance')
g+ annotate("text", x = 2000, y = 95, label = "10 points for 1st down 1 point for 10th")
g=ggplot()+ geom_step(data=res[res$code %in% leaders$code,], aes(x=year, y=totPts, col=code))
g=g+ geom_line(data=res[!(res$code %in% leaders$code),], aes(x=year, y=totPts, group=driverRef),col='grey')
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = code), na.rm = TRUE, arrow = arrow(length = unit(0.01, 'npc')), nudge_y =3, nudge_x =2, segment.size = 0.2,size=2)
g=g + guides(color=FALSE)+xlim(1995,2025)+ylim(0,100)+theme_bw()+ggtitle('F1 Australia - Albert Park - Driver Performance')
g+ annotate("text", x = 2000, y = 95, label = "10 points for 1st\ndown to 1 point for 10th")
g=ggplot()+ geom_step(data=res[res$code %in% leaders$code,], aes(x=year, y=totPts, col=code))
g=g+ geom_line(data=res[!(res$code %in% leaders$code),], aes(x=year, y=totPts, group=driverRef),col='grey')
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = code), na.rm = TRUE, arrow = arrow(length = unit(0.01, 'npc')), nudge_y =3, nudge_x =2, segment.size = 0.2,size=2)
g=g + guides(color=FALSE)+xlim(1995,2025)+ylim(0,100)+theme_bw()+ggtitle('F1 Australia - Albert Park - Driver Performance')
g+ annotate("text", x = 2000, y = 95, label = "10 points for 1st\ndown to 1 point for 10th")+ylab(NULL)
g=ggplot()+ geom_step(data=res[res$code %in% leaders$code,], aes(x=year, y=totPts, col=code))
g=g+ geom_line(data=res[!(res$code %in% leaders$code),], aes(x=year, y=totPts, group=driverRef),col='grey')
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = code), na.rm = TRUE, arrow = arrow(length = unit(0.01, 'npc')), nudge_y =3, nudge_x =2, segment.size = 0.2,size=2)
g=g + guides(color=FALSE)+xlim(1995,2025)+ylim(0,100)+theme_bw()+ggtitle('F1 Australia - Albert Park - Driver Performance')
g+ annotate("text", x = 2000, y = 95, label = "10 points for 1st\ndown to 1 point for 10th")+ylab('Total "Points"')+xlab(NULL)
g=ggplot()+ geom_step(data=res[res$code %in% leaders$code,], aes(x=year, y=totPts, col=code))
g=g+ geom_line(data=res[!(res$code %in% leaders$code),], aes(x=year, y=totPts, group=driverRef),col='grey')
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = code), na.rm = TRUE, arrow = arrow(length = unit(0.01, 'npc')), nudge_y =3, nudge_x =2, segment.size = 0.2,size=2)
g=g + guides(color=FALSE)+xlim(1995,2025)+ylim(0,100)+theme_bw()+ggtitle('F1 Australia - Albert Park - Driver Performance')
g=g+annotate("rect", xmin = 1995, xmax = 2000, ymin = 75, ymax = 100,
alpha = .2, col='pink)
g+ annotate("text", x = 2000, y = 95, label = "10 points for 1st\ndown to 1 point for 10th")+ylab('Total "Points"')+xlab(NULL)
g=ggplot()+ geom_step(data=res[res$code %in% leaders$code,], aes(x=year, y=totPts, col=code))
g=g+ geom_line(data=res[!(res$code %in% leaders$code),], aes(x=year, y=totPts, group=driverRef),col='grey')
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = code), na.rm = TRUE, arrow = arrow(length = unit(0.01, 'npc')), nudge_y =3, nudge_x =2, segment.size = 0.2,size=2)
g=g + guides(color=FALSE)+xlim(1995,2025)+ylim(0,100)+theme_bw()+ggtitle('F1 Australia - Albert Park - Driver Performance')
g=g+annotate("rect", xmin = 1995, xmax = 2000, ymin = 75, ymax = 100,
alpha = .2, col='pink')
g+ annotate("text", x = 2000, y = 95, label = "10 points for 1st\ndown to 1 point for 10th")+ylab('Total "Points"')+xlab(NULL)
g=ggplot()+ geom_step(data=res[res$code %in% leaders$code,], aes(x=year, y=totPts, col=code))
g=g+ geom_line(data=res[!(res$code %in% leaders$code),], aes(x=year, y=totPts, group=driverRef),col='grey')
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = code), na.rm = TRUE, arrow = arrow(length = unit(0.01, 'npc')), nudge_y =3, nudge_x =2, segment.size = 0.2,size=2)
g=g + guides(color=FALSE)+xlim(1995,2025)+ylim(0,100)+theme_bw()+ggtitle('F1 Australia - Albert Park - Driver Performance')
g=g+annotate("rect", xmin = 1995, xmax = 2000, ymin = 75, ymax = 100,
alpha = .2, fill='lightblue')
g+ annotate("text", x = 2000, y = 95, label = "10 points for 1st\ndown to 1 point for 10th")+ylab('Total "Points"')+xlab(NULL)
g=ggplot()+ geom_step(data=res[res$code %in% leaders$code,], aes(x=year, y=totPts, col=code))
g=g+ geom_line(data=res[!(res$code %in% leaders$code),], aes(x=year, y=totPts, group=driverRef),col='grey')
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = code), na.rm = TRUE, arrow = arrow(length = unit(0.01, 'npc')), nudge_y =3, nudge_x =2, segment.size = 0.2,size=2)
g=g + guides(color=FALSE)+xlim(1995,2025)+ylim(0,100)+theme_bw()+ggtitle('F1 Australia - Albert Park - Driver Performance')
g=g+annotate("rect", xmin = 1995, xmax = 2000, ymin = 75, ymax = 100,
alpha = 0, fill='lightblue')
g+ annotate("text", x = 2000, y = 95, label = "10 points for 1st\ndown to 1 point for 10th")+ylab('Total "Points"')+xlab(NULL)
g=ggplot()+ geom_step(data=res[res$code %in% leaders$code,], aes(x=year, y=totPts, col=code))
g=g+ geom_line(data=res[!(res$code %in% leaders$code),], aes(x=year, y=totPts, group=driverRef),col='grey')
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = code), na.rm = TRUE, arrow = arrow(length = unit(0.01, 'npc')), nudge_y =3, nudge_x =2, segment.size = 0.2,size=2)
g=g + guides(color=FALSE)+xlim(1995,2025)+ylim(0,100)+theme_bw()+ggtitle('F1 Australia - Albert Park - Driver Performance')
g=g+annotate("rect", xmin = 1995, xmax = 2000, ymin = 75, ymax = 100,
alpha = 1, fill='lightblue')
g+ annotate("text", x = 2000, y = 95, label = "10 points for 1st\ndown to 1 point for 10th")+ylab('Total "Points"')+xlab(NULL)
g=ggplot()+ geom_step(data=res[res$code %in% leaders$code,], aes(x=year, y=totPts, col=code))
g=g+ geom_line(data=res[!(res$code %in% leaders$code),], aes(x=year, y=totPts, group=driverRef),col='grey')
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = code), na.rm = TRUE, arrow = arrow(length = unit(0.01, 'npc')), nudge_y =3, nudge_x =2, segment.size = 0.2,size=2)
g=g + guides(color=FALSE)+xlim(1995,2025)+ylim(0,100)+theme_bw()+ggtitle('F1 Australia - Albert Park - Driver Performance')
g=g+annotate("rect", xmin = 1995, xmax = 2006, ymin = 75, ymax = 110,
alpha = 1, fill='lightblue')
g+ annotate("text", x = 2000, y = 95, label = "10 points for 1st\ndown to 1 point for 10th")+ylab('Total "Points"')+xlab(NULL)
g=ggplot()+ geom_step(data=res[res$code %in% leaders$code,], aes(x=year, y=totPts, col=code))
g=g+ geom_line(data=res[!(res$code %in% leaders$code),], aes(x=year, y=totPts, group=driverRef),col='grey')
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = code), na.rm = TRUE, arrow = arrow(length = unit(0.01, 'npc')), nudge_y =3, nudge_x =2, segment.size = 0.2,size=2)
g=g + guides(color=FALSE)+xlim(1995,2025)+ylim(0,110)+theme_bw()+ggtitle('F1 Australia - Albert Park - Driver Performance')
g=g+annotate("rect", xmin = 1995, xmax = 2006, ymin = 75, ymax = 110,
alpha = 1, fill='lightblue')
g+ annotate("text", x = 2000, y = 95, label = "10 points for 1st\ndown to 1 point for 10th")+ylab('Total "Points"')+xlab(NULL)
g=ggplot()+ geom_step(data=res[res$code %in% leaders$code,], aes(x=year, y=totPts, col=code))
g=g+ geom_line(data=res[!(res$code %in% leaders$code),], aes(x=year, y=totPts, group=driverRef),col='grey')
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = code), na.rm = TRUE, arrow = arrow(length = unit(0.01, 'npc')), nudge_y =3, nudge_x =2, segment.size = 0.2,size=2)
g=g + guides(color=FALSE)+xlim(1990,2025)+ylim(0,110)+theme_bw()+ggtitle('F1 Australia - Albert Park - Driver Performance')
g=g+annotate("rect", xmin = 1994, xmax = 2006, ymin = 75, ymax = 110,
alpha = 1, fill='lightblue')
g+ annotate("text", x = 2000, y = 95, label = "10 points for 1st\ndown to 1 point for 10th")+ylab('Total "Points"')+xlab(NULL)
g=ggplot()+ geom_step(data=res[res$code %in% leaders$code,], aes(x=year, y=totPts, col=code))
g=g+ geom_line(data=res[!(res$code %in% leaders$code),], aes(x=year, y=totPts, group=driverRef),col='grey')
g=g+geom_label_repel(data=leaders,aes(x=until, y=s,label = code), na.rm = TRUE, arrow = arrow(length = unit(0.01, 'npc')), nudge_y =3, nudge_x =2, segment.size = 0.2,size=2)
g=g + guides(color=FALSE)+xlim(1993,2025)+ylim(0,110)+theme_bw()+ggtitle('F1 Australia - Albert Park - Driver Performance')
g=g+annotate("rect", xmin = 1994, xmax = 2006, ymin = 75, ymax = 110,
alpha = 1, fill='lightblue')
g+ annotate("text", x = 2000, y = 95, label = "10 points for 1st\ndown to 1 point for 10th")+ylab('Total "Points"')+xlab(NULL)
